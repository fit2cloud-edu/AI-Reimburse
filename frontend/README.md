# å‘ç¥¨æŠ¥é”€å‰ç«¯ç³»ç»Ÿ (Fapiao Frontend)

ä¸€ä¸ªåŸºäº Vue 3 + TypeScript + Element Plus çš„ç°ä»£åŒ–å‘ç¥¨æŠ¥é”€å‰ç«¯åº”ç”¨ï¼Œæ”¯æŒä¼ä¸šå¾®ä¿¡é›†æˆå’Œæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 3.5.25 + TypeScript
- **æ„å»ºå·¥å…·**: Vite 7.2.4
- **UIç»„ä»¶åº“**: Element Plus 2.12.0
- **çŠ¶æ€ç®¡ç†**: Pinia 3.0.4
- **è·¯ç”±ç®¡ç†**: Vue Router 4.6.4
- **HTTPå®¢æˆ·ç«¯**: Axios 1.13.2
- **æ ·å¼é¢„å¤„ç†å™¨**: Sass 1.96.0
- **ä»£ç è§„èŒƒ**: ESLint + Prettier
- **æµ‹è¯•æ¡†æ¶**: Vitest + Playwright

## åŠŸèƒ½å®ç°è¯¦ç»†è¯´æ˜

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

#### ä¼ä¸šå¾®ä¿¡ç™»å½•é›†æˆ
- **ç¯å¢ƒæ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹æ˜¯å¦åœ¨ä¼ä¸šå¾®ä¿¡ç¯å¢ƒä¸­è¿è¡Œ
- **å¤šç§ç™»å½•æ–¹å¼**ï¼š
  - ä¼ä¸šå¾®ä¿¡å†…åµŒç™»å½•ï¼ˆä½¿ç”¨JSSDKï¼‰
  - æ–°çª—å£æ‰«ç ç™»å½•
  - å¿«é€Ÿç™»å½•ï¼ˆåœ¨ä¼ä¸šå¾®ä¿¡ç¯å¢ƒä¸­ï¼‰
- **è·¯ç”±å®ˆå«**ï¼šè‡ªåŠ¨é‡å®šå‘æœªè®¤è¯ç”¨æˆ·åˆ°ç™»å½•é¡µé¢
- **Tokenç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†è®¤è¯tokençš„å­˜å‚¨å’Œåˆ·æ–°

#### ç™»å½•æµç¨‹
1. ç¯å¢ƒæ£€æµ‹ â†’ 2. ç™»å½•æ–¹å¼é€‰æ‹© â†’ 3. ä¼ä¸šå¾®ä¿¡æˆæƒ â†’ 4. ç”¨æˆ·ä¿¡æ¯è·å– â†’ 5. è·¯ç”±è·³è½¬

### 2. å‘ç¥¨æŠ¥é”€æµç¨‹

#### å¤šæ­¥éª¤è¡¨å•è®¾è®¡
- **æ­¥éª¤1ï¼šé€‰æ‹©æŠ¥é”€ç±»å‹**
  - å›¾å½¢åŒ–ç±»å‹é€‰æ‹©ç•Œé¢
  - æ”¯æŒä¸¤ç§æŠ¥é”€è¡¨å•ç±»å‹ï¼ˆæ—¥å¸¸æŠ¥é”€ã€å·®æ—…æŠ¥é”€ï¼‰
  - å®æ—¶è¡¨å•éªŒè¯

- **æ­¥éª¤2ï¼šä¸Šä¼ å‘ç¥¨æ–‡ä»¶**
  - æ‰¹é‡æ–‡ä»¶ä¸Šä¼ æ”¯æŒ
  - æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆå›¾ç‰‡ã€PDFã€æ–‡æ¡£ï¼‰
  - æ–‡ä»¶å¤§å°é™åˆ¶æ§åˆ¶
  - ä¸Šä¼ è¿›åº¦æç¤º

- **æ­¥éª¤3ï¼šå¡«å†™æŠ¥é”€ä¿¡æ¯**
  - å®Œæ•´çš„æŠ¥é”€ä¿¡æ¯è¡¨å•
  - éƒ¨é—¨ä¿¡æ¯é€‰æ‹©
  - æ³•äººå®ä½“é€‰æ‹©
  - æ—¥æœŸé€‰æ‹©å™¨
  - å®æ—¶è¡¨å•éªŒè¯

#### æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- **FileUploaderç»„ä»¶**ï¼šæ”¯æŒæ‹–æ‹½ä¸Šä¼ ã€ç‚¹å‡»ä¸Šä¼ 
- **æ–‡ä»¶ç±»å‹è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ã€æ–‡æ¡£ç­‰æ–‡ä»¶ç±»å‹
- **ä¸Šä¼ è¿›åº¦ç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºä¸Šä¼ è¿›åº¦å’ŒçŠ¶æ€
- **é”™è¯¯å¤„ç†**ï¼šç½‘ç»œé”™è¯¯ã€æ–‡ä»¶ç±»å‹é”™è¯¯ç­‰å¼‚å¸¸å¤„ç†

### 3. çŠ¶æ€ç®¡ç†ä¸æ•°æ®æµ

#### Pinia Storeè®¾è®¡
- **Auth Store**ï¼šç”¨æˆ·è®¤è¯çŠ¶æ€ã€ç”¨æˆ·ä¿¡æ¯ã€ç™»å½•çŠ¶æ€
- **Reimbursement Store**ï¼šæŠ¥é”€è¡¨å•æ•°æ®ã€æ–‡ä»¶åˆ—è¡¨ã€æµç¨‹çŠ¶æ€

#### æ•°æ®æµæ¶æ„
ç”¨æˆ·æ“ä½œ â†’ Vueç»„ä»¶ â†’ Pinia Actions â†’ APIè°ƒç”¨ â†’ çŠ¶æ€æ›´æ–° â†’ UIå“åº”

### 4. ç»„ä»¶åŒ–æ¶æ„

#### æ ¸å¿ƒç»„ä»¶
- **FlowSteps**ï¼šæµç¨‹æ­¥éª¤æŒ‡ç¤ºå™¨ï¼Œæ”¯æŒæ­¥éª¤è·³è½¬
- **FileUploader**ï¼šæ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼Œæ”¯æŒå¤šç§ä¸Šä¼ æ–¹å¼
- **InvoiceCard**ï¼šå‘ç¥¨ä¿¡æ¯å±•ç¤ºå¡ç‰‡
- **ValidationMarker**ï¼šè¡¨å•éªŒè¯æ ‡è®°ç»„ä»¶
- **ProgressModal**ï¼šè¿›åº¦æ˜¾ç¤ºå¼¹çª—

### 5. APIæ¥å£è®¾è®¡

#### æ¥å£æ¨¡å—åŒ–
- **è®¤è¯æ¥å£** (`auth.ts`)ï¼šç™»å½•ã€é€€å‡ºã€ç”¨æˆ·ä¿¡æ¯
- **æŠ¥é”€æ¥å£** (`reimbursement.ts`)ï¼šæäº¤æŠ¥é”€ã€è·å–è®°å½•
- **éƒ¨é—¨æ¥å£** (`department.ts`)ï¼šéƒ¨é—¨åˆ—è¡¨ã€éƒ¨é—¨ä¿¡æ¯
- **æ–‡ä»¶ä¸Šä¼ æ¥å£** (`upload.ts`)ï¼šæ–‡ä»¶ä¸Šä¼ ã€è¿›åº¦æŸ¥è¯¢

#### è¯·æ±‚å°è£…
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**ï¼šç½‘ç»œé”™è¯¯ã€ä¸šåŠ¡é”™è¯¯ç»Ÿä¸€å¤„ç†
- **è¯·æ±‚æ‹¦æˆªå™¨**ï¼šè‡ªåŠ¨æ·»åŠ è®¤è¯token
- **å“åº”æ‹¦æˆªå™¨**ï¼šç»Ÿä¸€å¤„ç†å“åº”æ•°æ®å’Œé”™è¯¯
- **è¶…æ—¶é…ç½®**ï¼šåˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´è®¾ç½®

## é¡¹ç›®ç»“æ„
    src/ 
    â”œâ”€â”€ api/ # APIæ¥å£å®šä¹‰
    â”‚ â”œâ”€â”€ auth.ts # è®¤è¯ç›¸å…³æ¥å£ 
    â”‚ â”œâ”€â”€ department.ts # éƒ¨é—¨ç›¸å…³æ¥å£ 
    â”‚ â”œâ”€â”€ reimbursement.ts # æŠ¥é”€ç›¸å…³æ¥å£ 
    â”‚ â”œâ”€â”€ upload.ts # æ–‡ä»¶ä¸Šä¼ æ¥å£ 
    â”‚ â””â”€â”€ types.ts # TypeScriptç±»å‹å®šä¹‰ 
    â”œâ”€â”€ assets/ # é™æ€èµ„æº 
    â”‚ â””â”€â”€ main.css # å…¨å±€æ ·å¼ 
    â”œâ”€â”€ components/ # å…¬å…±ç»„ä»¶ 
    â”‚ â”œâ”€â”€ FileUploader.vue # æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ 
    â”‚ â”œâ”€â”€ FlowSteps.vue # æµç¨‹æ­¥éª¤ç»„ä»¶ 
    â”‚ â”œâ”€â”€ InvoiceCard.vue # å‘ç¥¨å¡ç‰‡ç»„ä»¶ 
    â”‚ â”œâ”€â”€ ProgressModal.vue # è¿›åº¦å¼¹çª—ç»„ä»¶ 
    â”‚ â””â”€â”€ ValidationMarker.vue # éªŒè¯æ ‡è®°ç»„ä»¶ 
    â”œâ”€â”€ config/ # é…ç½®æ–‡ä»¶ 
    â”‚ â””â”€â”€ company.ts # ä¼ä¸šé…ç½®ä¿¡æ¯ 
    â”œâ”€â”€ router/ # è·¯ç”±é…ç½® 
    â”‚ â””â”€â”€ index.ts # è·¯ç”±å®šä¹‰ 
    â”œâ”€â”€ store/ # çŠ¶æ€ç®¡ç† 
    â”‚ â”œâ”€â”€ auth.ts # è®¤è¯çŠ¶æ€ç®¡ç† 
    â”‚ â”œâ”€â”€ reimbursement.ts # æŠ¥é”€çŠ¶æ€ç®¡ç† 
    â”‚ â””â”€â”€ index.ts # Storeå…¥å£ 
    â”œâ”€â”€ utils/ # å·¥å…·å‡½æ•° 
    â”‚ â”œâ”€â”€ fileUtils.ts # æ–‡ä»¶å¤„ç†å·¥å…· 
    â”‚ â”œâ”€â”€ request.ts # HTTPè¯·æ±‚å°è£… 
    â”‚ â”œâ”€â”€ validators.ts # è¡¨å•éªŒè¯å·¥å…· 
    â”‚ â””â”€â”€ wxCompat.ts # å¾®ä¿¡å…¼å®¹å·¥å…· 
    â”œâ”€â”€ views/ # é¡µé¢ç»„ä»¶ 
    â”‚ â”œâ”€â”€ Login.vue # ç™»å½•é¡µé¢ 
    â”‚ â””â”€â”€ Reimbursement.vue # æŠ¥é”€é¡µé¢ 
    â”œâ”€â”€ App.vue # æ ¹ç»„ä»¶ 
    â””â”€â”€ main.ts # åº”ç”¨å…¥å£


## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **ä¼ä¸šå¾®ä¿¡é›†æˆç™»å½•**ï¼šæ”¯æŒå†…åµŒç™»å½•ã€æ‰«ç ç™»å½•ã€å¿«é€Ÿç™»å½•
- âœ… **å¤šæ­¥éª¤æŠ¥é”€æµç¨‹**ï¼šç±»å‹é€‰æ‹© â†’ æ–‡ä»¶ä¸Šä¼  â†’ ä¿¡æ¯å¡«å†™
- âœ… **æ‰¹é‡æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒå›¾ç‰‡ã€PDFã€æ–‡æ¡£ç­‰å¤šç§æ ¼å¼
- âœ… **æ™ºèƒ½è¡¨å•éªŒè¯**ï¼šå®æ—¶éªŒè¯ã€é”™è¯¯æç¤ºã€æäº¤æ§åˆ¶
- âœ… **éƒ¨é—¨ä¿¡æ¯ç®¡ç†**ï¼šåŠ¨æ€åŠ è½½éƒ¨é—¨åˆ—è¡¨ï¼Œæ”¯æŒéƒ¨é—¨é€‰æ‹©
- âœ… **ç”¨æˆ·çŠ¶æ€ç®¡ç†**ï¼šç™»å½•çŠ¶æ€æŒä¹…åŒ–ï¼Œè‡ªåŠ¨è·¯ç”±è·³è½¬

### æŠ€æœ¯ç‰¹æ€§
- ğŸ”¥ åŸºäºVue 3 Composition API
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯æ‰“å¼€
- ğŸ¨ Element Plus UIç»„ä»¶åº“
- ğŸ”’ TypeScriptç±»å‹å®‰å…¨
- ğŸš€ Viteå¿«é€Ÿæ„å»º

## ç¯å¢ƒè¦æ±‚

- Node.js: ^20.19.0 || >=22.12.0
- npm: 9.x æˆ–æ›´é«˜ç‰ˆæœ¬

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. ç¯å¢ƒé…ç½®
åœ¨ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­è®¾ç½®ç›¸åº”å‚æ•°ï¼š

```bash
# å¼€å‘ç¯å¢ƒ
cp .env.development .env.local

# ç”Ÿäº§ç¯å¢ƒ  
cp .env.production .env.local
```

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```
åº”ç”¨å°†åœ¨ http://localhost:3250 å¯åŠ¨

### 4. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
```

### 5. é¢„è§ˆç”Ÿäº§æ„å»º
```bash
npm run preview
```

## å¼€å‘è„šæœ¬

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check

# ä»£ç æ ¼å¼åŒ–
npm run format

# ä»£ç æ£€æŸ¥ä¸ä¿®å¤
npm run lint

# å•å…ƒæµ‹è¯•
npm run test:unit

# E2Eæµ‹è¯•
npm run test:e2e
```

## é…ç½®è¯´æ˜

### Viteé…ç½®
é¡¹ç›®ä½¿ç”¨Viteä½œä¸ºæ„å»ºå·¥å…·ï¼Œä¸»è¦é…ç½®åŒ…æ‹¬ï¼š
- è·¯å¾„åˆ«åï¼š`@` æŒ‡å‘ `src` ç›®å½•
- å¼€å‘æœåŠ¡å™¨ä»£ç†ï¼šå°† `/api` è¯·æ±‚ä»£ç†åˆ°åç«¯æœåŠ¡
- è‡ªåŠ¨å¯¼å…¥ï¼šElement Plusç»„ä»¶è‡ªåŠ¨å¯¼å…¥

### ä¼ä¸šé…ç½®
ä¼ä¸šç›¸å…³é…ç½®ä½äº `src/config/company.ts`ï¼ŒåŒ…æ‹¬ï¼š
- ä¼ä¸šIDé…ç½®
- åº”ç”¨é…ç½®ä¿¡æ¯
- APIåŸºç¡€è·¯å¾„

### APIé…ç½®
APIè¯·æ±‚é…ç½®ä½äº `src/utils/request.ts`ï¼ŒåŒ…å«ï¼š
- è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆæ·»åŠ è®¤è¯tokenï¼‰
- å“åº”æ‹¦æˆªå™¨ï¼ˆç»Ÿä¸€é”™è¯¯å¤„ç†ï¼‰
- è¶…æ—¶é…ç½®

## éƒ¨ç½²è¯´æ˜

### å¼€å‘ç¯å¢ƒéƒ¨ç½²
1. é…ç½®å¼€å‘ç¯å¢ƒå˜é‡
2. è¿è¡Œ `npm run build`
3. Login.vueä¸­â€œæµ‹è¯•ç™»å½•â€å…¥å£åœ¨å–æ¶ˆæ³¨é‡Šåå¯ç›´æ¥ä½¿ç”¨

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
1. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
2. è¿è¡Œ `npm run build`
3. é…ç½®Nginxåå‘ä»£ç†æˆ–vite.config.tsæ–‡ä»¶ä¸­å¡«å†™åç«¯æœåŠ¡è¿è¡Œåœ°å€
4. å¯ä»¥éƒ¨ç½²åˆ°æœåŠ¡å™¨

### Nginxé…ç½®ç¤ºä¾‹
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        root /path/to/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://your-backend-server/api;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°é¡µé¢
1. åœ¨ `src/views` ç›®å½•ä¸‹åˆ›å»ºVueç»„ä»¶
2. åœ¨ `src/router/index.ts` ä¸­æ·»åŠ è·¯ç”±é…ç½®
3. å¦‚éœ€APIè°ƒç”¨ï¼Œåœ¨ `src/api` ç›®å½•ä¸‹æ·»åŠ æ¥å£å®šä¹‰

### æ·»åŠ æ–°ç»„ä»¶
1. åœ¨ `src/components` ç›®å½•ä¸‹åˆ›å»ºVueç»„ä»¶
2. ç»„ä»¶æ”¯æŒè‡ªåŠ¨å¯¼å…¥ï¼Œæ— éœ€æ‰‹åŠ¨å¼•å…¥

### APIå¼€å‘è§„èŒƒ
- æ‰€æœ‰APIè¯·æ±‚ä½¿ç”¨ `src/utils/request.ts` å°è£…çš„axioså®ä¾‹
- æ¥å£å®šä¹‰ç»Ÿä¸€æ”¾åœ¨ `src/api` ç›®å½•
- TypeScriptç±»å‹å®šä¹‰æ”¾åœ¨ `src/api/types.ts`

### çŠ¶æ€ç®¡ç†
- ä½¿ç”¨Piniaè¿›è¡ŒçŠ¶æ€ç®¡ç†
- Storeæ¨¡å—åŒ–ç»„ç»‡ï¼ŒæŒ‰åŠŸèƒ½åˆ’åˆ†
- çŠ¶æ€å˜æ›´é€šè¿‡actionsè¿›è¡Œ

## æµ‹è¯•

### å•å…ƒæµ‹è¯•
```bash
npm run test:unit
```

### E2Eæµ‹è¯•
```bash
npm run test:e2e
```

## å¸¸è§é—®é¢˜

### Q: å¼€å‘æ—¶å¦‚ä½•é…ç½®ä»£ç†ï¼Ÿ
A: åœ¨ `vite.config.ts` çš„ `server.proxy` ä¸­é…ç½®åç«¯APIåœ°å€ã€‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„Element Plusç»„ä»¶ï¼Ÿ
A: é¡¹ç›®å·²é…ç½®è‡ªåŠ¨å¯¼å…¥ï¼Œç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å³å¯ã€‚

### Q: å¦‚ä½•ä¿®æ”¹ä¼ä¸šé…ç½®ï¼Ÿ
A: ä¿®æ”¹ `src/config/company.ts` ä¸­çš„é…ç½®é¡¹ã€‚

### Q: æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶å¦‚ä½•è°ƒæ•´ï¼Ÿ
A: åœ¨ `src/components/FileUploader.vue` ä¸­ä¿®æ”¹æ–‡ä»¶å¤§å°é™åˆ¶é…ç½®ã€‚